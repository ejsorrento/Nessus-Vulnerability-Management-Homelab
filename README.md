# Nessus-Vulnerability-Management-Homelab

![7_What_Is_Nessus](https://github.com/user-attachments/assets/b516bb17-ab03-435d-b9c8-230d4fc3fcbf)

**Summary**

**Platforms and Technology Used:** Tenable Nessus and Windows 10 virtual machine on VMWare

• Installed and configured Nessus Essentials to perform credentialed vulnerability scans against Windows 10 host.

• Implemented Vulnerability Management Function on sandbox network:
-Discover, Prioritize, Assess, Report, Remediate, Verify.

• Conducted vulnerability assessments with Nessus; identified and remediated risks and vulnerabilities

• Developed automated remediation process to preemptively deal with vulnerabilities stemming from Windows updates and third-party software.


**Introduction**

**Vulnerability management** is a practice that is ongoing and entails identifying, evaluating, reporting, and addressing cybersecurity vulnerabilities present in endpoints, workloads, and systems. **MITRE** is a highly respected organization in the information security real and provides critical frameworks such as the **Common Vulnerabilities and Exposres (CVE)** and the **Adversarial Tactics, Techniques, and Common Knowledge (ATT&CK)** framework, which play a vital role in the comprehension and remediation of vulnerabilities and threats.

The goal of this homelab is to obtain practical skills in utilizing the free version of **Tenable Nessus**, known as **Nessus Essentials** and gain proficiency in vulnerability scanning and administering remediation tactics. This project highlights two vital stages of the "Vulnerability Management Lifecycle" and it is done through the use of Nessues Essentials for vulnerability scan hosted on virtual machines on VMWare. In this exercise, I will demonstrate the running of credentialed scans to identify vulnerabilities, remediation tactics to resolve identified issues, and initiating of a follow-up scan to verify the successful remediation of the issues.

**Necessary Downloads:**

• Oracle VM VMWare for your operating system: https://www.VMWare.org/wiki/Downloads

• Windows 10: https://www.microsoft.com/en-us/software-download/windows10ISO

• Tenable Nessus Essentials: https://www.tenable.com/products/nessus/nessus-essentials

Go ahead and get started by downloading VMWare, the installation is straight forward and you'll be left with a landing screen similar to what is seen below.

<img width="771" alt="Screen Shot 2024-08-20 at 11 25 52 PM" src="https://github.com/user-attachments/assets/97b4331f-32f6-45fb-bd33-5fa65d61b1dc">

_Note, my VMWare has a few other projects listed in it, I've underlined in green the virtual machine we'll be working with to build this homelab. Utilize the above picture to put together the virtual machine we'll be creating._

Start by creating a "New" virtual machine and imputting the newly downloaded Windows ISO file into it. Configure the remainder of the settings to your preferences or to what you believe your computer is capable of processing and click "Finish" to complete the setup of the virtual machine.

<img width="949" alt="Nessus2" src="https://github.com/user-attachments/assets/9682b873-b501-4e4f-a7a9-7cbae59291cc">

Start your VM and go through the steps to set up Windows 10. Upon arriving to the homescreen, navigate to the "Command Prompt".

<img width="692" alt="Nessus3" src="https://github.com/user-attachments/assets/114e0f6f-c054-4681-af89-363a5b4571da">

At this point, we'll need to test the connection between the local machine and our brand new virtual machine, we'll test the connection by pinging the VM from the local machine. If this connection is not established, we will not be able to properly run the vulnerability scans from Nessus. Currently the pings will time out on the local machine due to the active firewall on the VM that is blocking all connection attempted.

Navigate to "Windows Firewall with Advanced Security" and click "Windows Defender Firewall Properties", turn off the "Firewall State" for Domain, Private, and Public profiles. Then reattempt the ping and you will now see successful result.

![Nessus4](https://github.com/user-attachments/assets/5c5958cd-dfac-4370-bb11-6bbc34450c7f)

_Please note, I originally ran into some issues after having alter the previously mentioned firewall settings on the virtual machine due to the fact that my VMs Network settings were "Attached to:" a NAT connection. Once I altered with connection to a Bridged Adapter, the pings began to be sent between the two machines as intended._

Move forward to the download of Nessus. I personally had an issue utilizing Nessus on a gmail account, therefore, I utilized my protonmail email address to generate the download link and aqcuire the activation code for Nessus Essentials. Download the installation file and initiaite the setup, this will take some time and you will be prompted to set up additional compilations of plugins afterward.

![Nessus5](https://github.com/user-attachments/assets/0d814dbd-6b8e-44c7-bf11-b505b3876f6e)

Once you've gotten into Nessus Essentials, begin creating a new scan and select "Basic Network Scan". Name the scan and input the IP address of the virtual machine as the Target. See below three images.

![Nessus6](https://github.com/user-attachments/assets/a89d74bf-b728-4a48-9d23-b499fc87277a)

_New scan with VM's IP address, create a new scan. (1 of 3)_

![Nessus7](https://github.com/user-attachments/assets/5b7a7edc-5d94-4d92-92f8-63bcf87f2527)

_New scan with VM's IP address, choose "Basic Network Scan". (2 of 3)_

![Nessus8](https://github.com/user-attachments/assets/d90cbca8-9548-4cc5-86d7-c84f7db9883e)

_New scan with VM's IP address, name scan and input IP address. (3 of 3)_

Begin running the scan. Once it is completed, you'll see that there is very vague and limited amount of information available due to the fact that the inital scan lacked credentials from the VM. In fact, 93.33% of the entire scan falls into the "Information" category of vulnerabilities and the low and medium vulnerabilities each equate to 3.33%. Severity levels of these vulnerabilities are indicated by different colors in the scans: blue signifies information, green for low, yellow for medium, orange for high, and red for critical. These colors aid in the identification of vulnerability severity and help in the prioritization and addressing of the most critical issues as soon as possible. See below.

<img width="1062" alt="Nessus9" src="https://github.com/user-attachments/assets/832038cb-e13b-4af1-89fc-aa286ca5c3b1">

_Evaluating results of executed scan. (1 of 2)_

<img width="1186" alt="Nessus10" src="https://github.com/user-attachments/assets/bb68d1d0-b72a-4ca6-bcb6-8c70641e016c">

_Evaluating results of executed scan. (2 of 2)_

Each organization has different ways of prioritizing vulnerabilities, one may focus on high to critical severity issues due to the high volume of crucial circumstances, while potentially ignoring low to medium severity matters due to the overwhelming amount of volume they are experiencing. Due to the fact that we did not use credentials for our scan, we've left a significant amount of vulnerabilities undetected from the VM.

Moving forward, we'll set up the VM to accept authenticated scans. Next, I'll configure the VM for credentialed scans and provide those credentials to Nessus. Once all of this is set up, I'll rescan the VM with credentials and differentiate and compare the results of the first scan and the new scan. Providing credentials will allow us to further understand the security posture of the system and identify potential vulnerabilities the could not be seen in the original scan. 

Going back to the VM, we'll need to enable "Remote Registry", this will allow Nessus to connect to the VM's registry and perform a proper scan for vulnerabilties, including identifying insecure connections or deprecated cipher suites.

![Nessus11](https://github.com/user-attachments/assets/2fe7fefb-0552-4386-873b-53d89d42f80b)

_Adjusting Remote Registry settings (1 of 2)_

![Nessus12](https://github.com/user-attachments/assets/abf9a343-a74e-4a86-a105-1c9120f8b94c)

_Adjusting Remote Registry settings (2 of 2)_

After enablling Remote Registry and scanning for insecure configurations, the next step is to disable User Account Control (UAC), but this is unwise as it posess a compromise to the system's security. Alternatively, we are going to choose the "Run as administrator" option when needed for tasks that require escalated privileges.

![Nessus13](https://github.com/user-attachments/assets/dfb6f46a-843a-4f8e-9e9d-cf851866b68a)

_Deactivation of User Account Control_

Next, open the registry and add the key (HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\policies\system\LocalAccountTokenFilterPolicy) that will allow the remote account to establish its connection. Afterwards, I'll connect to the registry and add an additional key to the further disable User Account Control (UAC) for the remote account. This adjustment will make the connection possible during the scan process.

![Nessus14](https://github.com/user-attachments/assets/f0f9ab40-a56e-4967-bcaf-8118b9e9d349)

Establishing a New Registry Key.

Next, we will move to enable file and printer sharing, this will provide additional advantages for Nessus assessments. This authorizes Nessus to access shared files, intensifying scan accuracy and broadness through the analysis of configurations and logs.

![Nessus15](https://github.com/user-attachments/assets/6e3f7831-697c-4a38-90f1-4d8178aec8f0)

_Enabling File and Printer sharing._

After mading these changes to the VM, we'll move on to running a new scan using Nessus only this time utilizing the Kali Linux VM's login credentials. These credentials grant Nessus the ability to gather critical information stored within the VM's registry, this provides a more in-depth scan result.

![Nessus16](https://github.com/user-attachments/assets/8dcfbb8d-b6a2-4ed7-af7c-c9ade1335194)

_The Second Nessus Scan This Time With Credentials (1 of 2)_

With this most recent scan, we notice that there is now one Critical vulnerability, two Highs, four mediums, and 74 Information-based vulnerabilities. Since Nessus was empowered with the ability to embed itself deeper into the VM, it was able to gain more specified results.

<img width="1014" alt="Nessus17" src="https://github.com/user-attachments/assets/c6dfc424-bfd6-4cc5-ba6c-971fdb5adaa9">

_The Second Nessus Scan This Time With Credentials (2 of 2)_

Taking a deeper look into the vulnerabilities, we'll notice that: 

91.36% (74) of the vulnerabilities associated with this scan fall into the information category, 4.94% (4) are medium, 2.47% are high (2), and 1.23% (1) is of critical grade. One aspect to note is that the critical vulnerability found has a CVSS score of 8.8, putting it at in the severe vulnerability category.

Specifically, within the critical vulnerabilities we have outdated software for Google Chrome, VMWare, and the current MacOS being used. Nessus' suggestion for each includes simply updating these outdated softwares to remediate the critical vulnerabilities. Before we do this though, we going to go to the next step and continue making this VM more insecure in order to further test the capabilities of Nessus. We'll add an outdated version of Firefox, VLC Player, and Adobe Reader to further create vulnerabilities and explore the risks associated with utilizing outdated software.

![Nessus18](https://github.com/user-attachments/assets/bf4267bf-7e7e-4880-9efc-cc563bcdc9ed)

_Installing outdated software._

After running the third scan, we notice a significant increase in Critical vulnerabilities due to the installation of the outdated software. Under the "Remediations" section, Nessus provides guidance on addressing the vulnerabilities by upgrading the outdated software versions. 

<img width="1082" alt="Nessus19" src="https://github.com/user-attachments/assets/a6b2eb6e-e8cf-4e7a-a87f-9d2fc5df9c0a">

_Examining scan results and addressing remediation steps (1 of 2)_

<img width="1089" alt="Nessus20" src="https://github.com/user-attachments/assets/daee80cc-9306-4ef5-9738-94cdb42274f3">

_Examining scan results and addressing remediation steps (2 of 2)_

Now that we've created a very insecure virtual machine, we can go through the remediation process by uninstalling the outdated software and updating Windows 10 to its latest version. By doing this, we are able to tackle as many vulnerabilities as possible while enhancing the overall security posture of the virtual machine.
